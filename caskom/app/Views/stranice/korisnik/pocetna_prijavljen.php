<html lang="en">
    <!--Aleksa Vukovic 18/0354 -->
<head>
    <meta charset="utf-8">
    <title>Pocetna</title>
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Marcellus&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="<?php echo base_url('css/korisnik/pocetna.css'); ?>">
    <link rel="stylesheet" href="<?php echo base_url('css/korisnik/meni_prijavljen.css'); ?>">
    <link rel="stylesheet" href="<?php echo base_url('css/korisnik/body.css'); ?>">
    <script src="https://code.jquery.com/jquery-3.6.0.slim.min.js" integrity="sha256-u7e5khyithlIdTpu22PHhENmPcRdFiHRjhAuHcs05RI=" crossorigin="anonymous"></script>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

</head>
<body>
    <div class=cela_strana>
        <div class='kontent' style="z-index:0">
            <div class="container-fluid">
                <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel" style="width:100%">
                    <ol class="carousel-indicators">
                        <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
                        <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
                        <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
                    </ol>
                    <div class="carousel-inner">
                        
                        <div class="carousel-item active" style="background-color:rgb(2,2,4);">
                            <img class="img2" src="<?php echo base_url('images/ap_panther2.jpg'); ?>" alt="Second slide">
                            <div class="carousel-caption">
                                <h1 class="naslov2">Audemars Piguet Royal Oak Concept Black Panther Flying Tourbillon</h1>
                                <p class="slajd2_tekst1">
                                    Audemars Piguet odaje počast novoj generaciji uticajnih Marvelovih junaka u ograničenom izdanju od 250 komada posvećenih Crnom Panteru. Ukorenjen u zanatskim veštinama predaka, eksperimentisanju u dizajnu i futurističkoj tehnologiji, ovaj koncept Royal Oak pulsira pojačanom snagom.
                                </p>
                                <p class="slajd2_tekst2">
                                    Inspirisan najmodernijim odelom Crnog Pantera, peskareno titanijumsko kućište predstavlja teksturni izgled sa ulošcima od poliranog titanijuma. Crni keramički okvir od keramike unapređuje visokotehnološki dizajn sata.
                                    </br>
                                    </br>
                                    Brojčanik predstavlja ručno oslikanu izvedbu junaka, sačinjenu od belog zlata. Dok je tekstura odela laserski isklesana, bezbroj detalja koji ukrašavaju junakove ruke, kandže, mišiće i crte lica vaja se ručno. Brojni slojevi razređene tamne boje precizno su dodani rukom kako bi se postigao savršen balans teksture, kontrasta i dubine.
                                </p>
                            </div>
                        </div>
                        <div class="carousel-item" >
                            <img class="img1" src="<?php echo base_url('images/submariner.png'); ?>" alt="First slide">
                            <div class="carousel-caption">
                                <h1 class='naslov1'>Rolex Submariner</h1>
                            <p class="slajd1tekst">
                                
                                Pedesetih godina prošlog veka funkcionalni sportski modeli satova doživeli su značajnu popularizaciju. Postali su estetski simbol i uglavnom su bili vezivani za sportsku eleganciju. U tu priču uplela se i švajcarska manufaktura satova, a danas najpoznatiji brend na svetu – Rolex.
                                </br>
                                </br>
                                Rene-Paul Jeanneret, uticajna ličnost u tadašnjoj strukturi švajcarskog proizvođača i pasionirani ronilac, je začetnik ideje o jednom od najpopularnijih satova današnjice. Po njemu, model je morao biti vodootporan na velikim dubinama, a ujedno lep na oko i udoban za nošenje. Prevashodno je trebalo da ima funkciju koja će biti namenjena roniocima i koja će im omogućiti lakše bavljenje ovim sportom. Tako je kompanija Rolex 1953. godine predstavila model Submariner, koji će kasnije postati najpopularniji model njihovog širokog spektra. Tada je to bio jedini sat na svetu otporan na dubine do 100 metara.
                                </br>
                                </br>
                                Ronioci tog doba nisu imali današnju modernu tehnologiju na raspolaganju, te su vreme zaranjanja i vreme provedeno pod vodom morali da mere ručno. Tu uskače Submariner, sa svojim čuvenim rotirajućim okvirom, koji omogućava roniocu da vreme označi vreme zaranjanja. Dakle, okretanjem okvira tako da se nula podudara sa minutnom kazaljkom, ronilac može tačno da izmeri koliko vremena je bio u vodi.
                                </br>
                                </br>
                                Rolex Submariner i danas uživa veliku popularnost na globalnom nivou, i može se reći da je omiljeni model ljubitelja ove švajcarske kompanije.
                                </br>
                                </br>
                                Jedna od stvari koja je izvanredna kod ovog sata je to što je osećaj na ruci baš onakav kakav ste zamišljali i očekivali – čvrst, težak i sveden. Dizajniran tako da služi ceo vek, kako spolja, tako i unutra. Od 1988. godine svaki Submariner pokreće Rolexov mehanizam 3135, poznat po svojoj preciznosti i tvrdoći. Ovaj mehanizam sa švajcarskim sertifikatom odlikuje samonavijajući hronometar i panachrom povratna orpuga, koja pruža značajnu otpornost na udarce.
                                </br>
                                </br>
                                
                            </p>
                            </div>
                        </div>
                        <div class="carousel-item" style="background-color:rgb(0,0,0);">
                            <img class="img3" src="<?php echo base_url('images/bugatti.jpg'); ?>" alt="Third slide">
                            <div class="carousel-caption">
                                <h1 class="naslov3">Jacob & Co. x Bugatti Chiron Tourbillon</h1>
                                <p class="slajd3_tekst1">
                                    Počelo je sa idejom koju su zajedno sa Bugattijem osmislili Jacob & Co. - kako reprodukovati visceralnu senzaciju kultnog Bugatti-jevog 16-cilindričnog motora u časovniku.
                                    </br>
                                    </br>
                                    Posle skoro cele godine razvoja, odgovor je ovde u obliku Bugatti Chiron Tourbillon. Slučaj je inspirisan letećim linijama Chirona, a pokret, ili „blok motora“, namenjen dupliciranju motora Bugatti, postavljen je ispod masivnog safirovog kristala.
                                </p>
                                <h3 class='podnaslov'>Animacija motora</h3>
                                <p class="slajd3_tekst2">
                                    
                                    Ovde postaje zanimljivo: pritisnite desnu krunicu sata i motor oživi - radilica se okreće i 16 klipova pumpa gore-dole, baš kao pravi motor sa unutrašnjim sagorevanjem. Dva „turbopunjača“ (u poređenju sa četiri u stvarnom Chironovom motoru) na bočnoj strani bloka motora okreću se dok motor radi, dodajući vizuelni udar.
                                    </br>
                                    </br>
                                    Neverovatan za videti i neverovatno komplikovan za realizaciju (pokret se sastoji od 578 komponenti), časovnik Bugatti Chiron Tourbillon učinio je nešto što niko nikada ranije nije ni pokušao - da neprimetno oženi motore i satove.
                                    </br>
                                    </br>
                                    </br>
                                </p>
                            </div>
                        </div>
                    </div>
                    <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="sr-only">Previous</span>
                    </a>
                    <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="sr-only">Next</span>
                    </a>
                </div>
            </div>
        </div>
        
        <div class="hoverzone" id='hoverzone' onmouseover="hovered()"></div>
        <div class='popularniBrendovi'>
            <ul>
                <a href="https://www.rolex.com/">
                    <li class='prvi_u_listi'>Rolex</li>
                </a>
                <a href="https://www.patek.com/">
                    <li>Patek Philippe</li>
                </a>
                <a href="https://www.richardmille.com/">
                    <li>Richard Mille</li>
                </a>
                <a href="https://www.jacobandco.com/">
                    <li>Jacob & Co.</li>
                </a>
                <a href="https://www.audemarspiguet.com/">
                    <li>Audemars Piguet</li>
                </a>
                <a href="https://www.omegawatches.com/">
                    <li>Omega</li>
                </a>
                <a href="https://www.tudorwatch.com/">
                    <li>Tudor</li>
                </a>
                <a href="https://www.breitling.com/">
                    <li>Breitling</li>
                </a>
            </ul>
        </div>
        <div class=linija_menija id='navbar' style="background-color: rgb(28, 28, 29); animation: ani33 0.6s linear; height:12vh">
            <div class="moj_profil" style="width: 8.5%; height:80%; ">
                <a href="<?php echo base_url('Korisnik/moj_profil'); ?>" style="margin-left:7vw;">
                    <h2 style="width:10vw !important">Moj profil</h2>
                    <img style="margin-left:-0.75vw; width:18%"src="<?php echo base_url('images/profile_picture.png'); ?>" alt="">
                </a>
            </div>
            <div class=meni_info style="margin-left: 35vw">
                <ul>
                    <li><a href='<?php echo base_url('Korisnik/index'); ?>' class="pocetna_link">Početna</a></li>
                    
                    <li><a href='<?php echo base_url('Korisnik/ponuda'); ?>' class="ponuda">Ponuda</a></li>
                </ul>
            </div>
            <div class=logo_naziv>
                <a href="<?php echo base_url('Korisnik/index'); ?>">
                    <div class='logo_wrapper'>
                        
                        <h2 class="naziv" style="font-weight:bold">ČASKOM</h2>
                    </div>
                </a>
            </div>
        </div>
        <div class='div_search_bar'>
            <form name="pretragaOglasa" method="get" action="<?php echo site_url("Korisnik/pretraga")?>" >
                <input class="search__input"  name="pretraga" type="text" placeholder="Pretrazi" autocomplete="off">
            </form>
        </div>
        <div class='wrapper_slika'>
            <div class=div_sata>
                <a href="<?php echo site_url("Korisnik/oglas/5")?>">
                    <div class="slika1"></div>
                </a>
            </div>
            <div class=div_sata>
                <a href="<?php echo site_url("Korisnik/oglas/6")?>">
                    <div class="slika2"></div>
                </a>
            </div>
            <div class=div_sata>
                <a href="<?php echo site_url("Korisnik/oglas/7")?>">
                    <div class="slika3"></div>
                </a>
            </div>
            <div class=div_sata>
                <a href="<?php echo site_url("Korisnik/oglas/8")?>">
                    <div class="slika4"></div>
                </a>
            </div>
            <div class=div_sata>
                <a href="<?php echo site_url("Korisnik/oglas/14")?>">
                    <div class="slika5"></div>
                </a>
            </div>
        </div>
        <div class='wrapper_naziva_i_cena'>
            <div class="naziv_cena">
                <span class="cena">$ 14,999</span>
                <span class="naslov_sata">Rolex GMT-Master II - Batman</span>
            </div>
            <div class=naziv_cena>
                <span class="cena">$ 199,000</span>
                <span class="naslov_sata">Vacheron Constantin Twin Beat</span>
            </div>
            <div class=naziv_cena>
                <span class="cena">$ 125,999</span>
                <span class="naslov_sata">Patek Philippe Nautilus 5980/1AR</span>
            </div>
            <div class=naziv_cena>
                <span class="cena">$ 10,999</span>
                <span class="naslov_sata">Rolex Datejust 41 Rhodium Oyster</span>
            </div>
            <div class=naziv_cena>
                <span class="cena">$ 36,400</span>
                <span class="naslov_sata">Audemars Piguet Royal Oak Chronograph Steel</span>
            </div>
        </div>
        
        <div class="galerija">
            <div class="slika_galerija" style="background-image: url(../../images/richardLimited.jpg)"></div>
            <div class="slika_galerija" style="background-image: url(../../images/jacobDragon.png)"></div>
            <div class="slika_galerija" style="background-image: url(../../images/patekBack.jpg)"></div>
            <div class="slika_galerija" style="background-image: url(../../images/louis.jpg)"></div>
            <div class="slika_galerija" style="background-image: url(../../images/hublot1.jpg)" style="background-size: contain;"></div>
            <div class="slika_galerija" style="background-image: url(../../images/louis4.jpg)"></div>
            <div class="slika_galerija" style="background-image: url(../../images/apCeramic.jpg)"></div>
            <div class="slika_galerija" style="background-image: url(../../images/louis3.jpg)"></div>
            <div class="slika_galerija" style="background-image: url(../../images/vc.jpg)"></div>
            <div class="slika_galerija" style="background-image: url(../../images/pp.jpg)"></div>
        </div>
    </div>
    <div id="ikonica_ceta" class="ikonica_ceta" onclick="prikazCeta()">
    </div>
    <div class="veliki_cet" id="veliki_cet">
        <div class="linija_zatvaranje">
            <div class="zatvori" onclick="prikazCeta()">

            </div>
        </div>
        <div class="linija_poruka" id="linija_poruka" onclick="sendClick()">
            <!-- <div class="div_poruke_primljena">  
                <div class="poruka_primljena" onclick="sendClick()"> 
                    <span class="tekst_poruke">' + msg/* .message */ + '</span> 
                </div> 
            </div> -->
            <?php 
                if (isset($poruke) && count($poruke)) {
                    foreach ($poruke as $poruka) {
                        $ownerClassDiv = '';
                        $ownerClass = '';
                        if ($poruka->tip_autora == false) { 
                            $ownerClassDiv = 'div_poruke_primljena';
                            $ownerClass = 'poruka_primljena';
                        }
                        else {
                            $ownerClassDiv = 'div_poruke_poslata';
                            $ownerClass = 'poruka_poslata';
                        }
                        echo "<div class='$ownerClassDiv'> <div class='$ownerClass' onclick='sendClick()'> <span class='rekst_poruke'> $poruka->tekst </span> </div> </div>";
                    }
                }
            ?>
        </div>
        <div class="linija_slanja" id="linija_slanja">
            <textarea name="" id="tekst" onclick="textareaClick()"></textarea>
            <div class="send_icon" id="input_button" onclick="sendClick()">

            </div>
        </div>
    </div>
</body>
<script>
    var prevScrollpos = window.pageYOffset;
    window.onscroll = function () {
        var currentScrollPos = window.pageYOffset;
        if (prevScrollpos > currentScrollPos) {
            document.getElementById("navbar").style.top = "0";
        } else {
            document.getElementById("navbar").style.transitionDuration = "0.4s";
            document.getElementById("navbar").style.top = "-150px";
        }
        prevScrollpos = currentScrollPos;
    }
</script>
<script>
    function hovered() {
        document.getElementById("navbar").style.top = "0";
        document.getElementById("navbar").style.transitionDuration = "0.6s";
        
    }
</script>

<script>
    function prikazCeta(){
        let div_velikog_ceta = document.getElementById("veliki_cet");
        if(div_velikog_ceta.style.visibility == "hidden"){
            div_velikog_ceta.style.transition = "opacity 0.3s ease-in 0.15s,margin-top 0.6s, visibility 0.6s, margin-bottom 0.4s ease-out, bottom 0.5s linear";
            div_velikog_ceta.style.bottom = "0";
            div_velikog_ceta.style.visibility = "visible";
            div_velikog_ceta.style.opacity = "1";
        }
        else{
            div_velikog_ceta.style.transition = "opacity 0.15s, margin-top 0.6s, visibility 0.6s, margin-bottom 0.5s ease-in, bottom 0.5s ease-out";
            div_velikog_ceta.style.bottom = "-450px";
            div_velikog_ceta.style.visibility = "hidden";
            div_velikog_ceta.style.opacity = "0";
        }
    }
  
    function textareaClick(){
        let tekstarea = document.getElementById("tekst");
        let linijaSlanja = document.getElementById("linija_slanja");
        let linijaPoruka = document.getElementById("linija_poruka");
        if(document.activeElement == tekstarea){
            linijaPoruka.style.transition = "0.2s ease-out";
            linijaPoruka.style.height = "76%";
            linijaSlanja.style.height = "21%";
            tekstarea.style.height = "75%";
            tekstarea.style.width = "78%";
            tekstarea.style.marginRight = "5%";
            tekstarea.style.paddingTop = "3%";
            tekstarea.style.fontSize = "0.75vw";
        }
    }

    function sendClick(){
        let tekstarea = document.getElementById("tekst");
        let linijaSlanja = document.getElementById("linija_slanja");
        let linijaPoruka = document.getElementById("linija_poruka");
        linijaPoruka.style.transition = "0s linear";
        linijaPoruka.style.height = "85%";
        linijaSlanja.style.height = "11%";
        tekstarea.style.height = "50%";
        tekstarea.style.width = "60%";
        tekstarea.style.marginRight = "22%";
        tekstarea.style.paddingTop = "1%";
        tekstarea.style.fontSize = "0.7vw";
        
    }
</script>
<script>
    var conn = null;

    $(function () {
        scrollMsgBottom();
        reloadConversation();
        addEventListeners();
    })

    function reloadConversation() {
        if (<?php 
            if (isset($poruke) && count($poruke) > 0) echo 'true';
            else echo 'false';
        ?>) {
            openConnection();
        }
    }

    function addEventListeners() {
        $('#input_button').on('click', function() {
            var msg = $('#tekst').val();
            if(msg.trim() == '') return false;
            if (msg.length > 255) msg = msg.substring(0, 255);
            myMessage(msg);
            $('#tekst').val('')
            var pckg = [<?= session()->get('korisnik')->idK ?>, 1, msg, null];;
            if (conn == null) {
                openConnection();
                setTimeout(function(){ conn.send(JSON.stringify(pckg)); }, 2000);
            }
            else conn.send(JSON.stringify(pckg));
        })

        $('#ikonica_ceta').on('click', function() {
            if (conn == null) {
                clearChat();
                openConnection();
            }
        });

    }

    function openConnection(){
        if (conn == null) {
            conn = new WebSocket('ws://localhost:8081?access_token=<?= session()->get('korisnik')->idK ?>&client_type=1');
            conn.onopen = function(e) {
                console.log("Connection established!");
            }; 
            conn.onmessage = function(e) {
                let data = JSON.parse(e.data);
                if (!('method' in data)) return;
                if (data.method.localeCompare("MSG") == 0) {
                    newMessage(data.message);
                }
                else if (data.method.localeCompare("END") == 0) {
                    newMessage("***VAŠ TICKET JE ZATVOREN OD STRANE MODERATORA***");
                    conn.close();
                    conn = null;
                }
            };
        }
    }

    function newMessage(msg){
      html = '<div class="div_poruke_primljena"> <div class="poruka_primljena" onclick="sendClick()"> <span class="tekst_poruke">' + msg + '</span> </div> </div>';
      $('#linija_poruka').append(html);
      scrollMsgBottom();
    }

    function myMessage(msg){
      html = '<div class="div_poruke_poslata"> <div class="poruka_poslata" onclick="sendClick()"> <span class="tekst_poruke">' + msg + '</span> </div> </div>';
      $('#linija_poruka').append(html);
      scrollMsgBottom();
    }

    function scrollMsgBottom(){
        var d = $('#linija_poruka');
        d.scrollTop(d.prop("scrollHeight"));
    }

    function clearChat() {
        $("#linija_poruka")[0].innerHTML = '';
    }

</script>
</html>